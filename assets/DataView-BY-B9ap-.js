import{Y as K,m as q,e as X,d as C,c as b,a as e,b as G,o as p,_ as F,t as g,A,F as I,r as U,Z as L,p as M,f as N,x as P,$ as w,a0 as O,X as Y,a1 as Z,a2 as H,K as Q,P as W,a3 as z,a4 as x,n as ee,k as j}from"./index-JkLA6S0A.js";var $=(h=>(h.STRING="string",h.NUMBER="number",h.BOOLEAN="boolean",h.DATE="date",h.JSON="json",h))($||{});function B(h,s,t){return{id:`var_${Date.now()}`,name:h,type:s,value:t,createdAt:new Date,updatedAt:new Date}}function J(h,s){return{id:`table_${Date.now()}_${h}`,name:h,description:s,fields:[],records:[],createdAt:new Date,updatedAt:new Date}}function te(h,s){return{id:`field_${Date.now()}`,name:h,type:s,required:!1,defaultValue:se(s)}}function se(h){switch(h){case"string":return"";case"number":return 0;case"boolean":return!1;case"date":return new Date().toISOString();case"json":return{};default:return null}}const ae=K("data",()=>{const h=q([B("用户名",$.STRING,"admin"),B("登录次数",$.NUMBER,0),B("是否管理员",$.BOOLEAN,!0),B("最后登录时间",$.DATE,new Date().toISOString())]),s=q([]),t=q(null),l=()=>{if(s.value.length===0){const d=J("用户表","存储用户基本信息");d.fields=[{id:"field_1",name:"用户名",type:$.STRING,required:!0,defaultValue:""},{id:"field_2",name:"邮箱",type:$.STRING,required:!0,defaultValue:""},{id:"field_3",name:"年龄",type:$.NUMBER,required:!1,defaultValue:0},{id:"field_4",name:"是否激活",type:$.BOOLEAN,required:!1,defaultValue:!0},{id:"field_5",name:"注册时间",type:$.DATE,required:!1,defaultValue:new Date().toISOString()}],d.records=[{id:"record_1",用户名:"张三",邮箱:"zhangsan@example.com",年龄:25,是否激活:!0,注册时间:"2024-01-15"},{id:"record_2",用户名:"李四",邮箱:"lisi@example.com",年龄:30,是否激活:!0,注册时间:"2024-01-20"},{id:"record_3",用户名:"王五",邮箱:"wangwu@example.com",年龄:28,是否激活:!1,注册时间:"2024-01-25"}],s.value.push(d);const c=J("产品表","存储产品信息");c.fields=[{id:"field_6",name:"产品名称",type:$.STRING,required:!0,defaultValue:""},{id:"field_7",name:"价格",type:$.NUMBER,required:!0,defaultValue:0},{id:"field_8",name:"库存",type:$.NUMBER,required:!1,defaultValue:0},{id:"field_9",name:"是否上架",type:$.BOOLEAN,required:!1,defaultValue:!1}],c.records=[{id:"record_4",产品名称:"iPhone 15",价格:5999,库存:100,是否上架:!0},{id:"record_5",产品名称:"MacBook Pro",价格:12999,库存:50,是否上架:!0},{id:"record_6",产品名称:"iPad Air",价格:4399,库存:80,是否上架:!1}],s.value.push(c),s.value.length>0&&(t.value=s.value[0].id)}},n=X(()=>t.value&&s.value.find(d=>d.id===t.value)||null);function R(d,c,r){const T=B(d,c,r);return h.value.push(T),T}function i(d,c){const r=h.value.find(T=>T.id===d);return r?(Object.assign(r,c,{updatedAt:new Date}),!0):!1}function _(d){const c=h.value.findIndex(r=>r.id===d);return c===-1?!1:(h.value.splice(c,1),!0)}function f(d,c){const r=J(d,c);return s.value.push(r),r}function D(d,c){const r=s.value.find(T=>T.id===d);return r?(Object.assign(r,c,{updatedAt:new Date}),!0):!1}function S(d){const c=s.value.findIndex(r=>r.id===d);return c===-1?!1:(s.value.splice(c,1),t.value===d&&(t.value=null),!0)}function V(d){return s.value.find(r=>r.id===d)?(t.value=d,!0):!1}function E(d,c,r){const T=s.value.find(y=>y.id===d);if(!T)return null;const o=te(c,r);return T.fields.push(o),T.updatedAt=new Date,o}function m(d,c,r){const T=s.value.find(y=>y.id===d);if(!T)return!1;const o=T.fields.find(y=>y.id===c);return o?(Object.assign(o,r),T.updatedAt=new Date,!0):!1}function v(d,c){const r=s.value.find(y=>y.id===d);if(!r)return!1;const T=r.fields.findIndex(y=>y.id===c);if(T===-1)return!1;const o=r.fields[T].name;return r.fields.splice(T,1),r.records.forEach(y=>{delete y[o]}),r.updatedAt=new Date,!0}function a(d,c){const r=s.value.find(T=>T.id===d);return r?(r.records.push({...c,id:`record_${Date.now()}`}),r.updatedAt=new Date,!0):!1}function k(d,c,r){const T=s.value.find(o=>o.id===d);return!T||c<0||c>=T.records.length?!1:(Object.assign(T.records[c],r),T.updatedAt=new Date,!0)}function u(d,c){const r=s.value.find(T=>T.id===d);return!r||c<0||c>=r.records.length?!1:(r.records.splice(c,1),r.updatedAt=new Date,!0)}return{variables:h,tables:s,currentTableId:t,currentTable:n,addVariable:R,updateVariable:i,deleteVariable:_,addTable:f,updateTable:D,deleteTable:S,selectTable:V,addField:E,updateField:m,deleteField:v,addRecord:a,updateRecord:k,deleteRecord:u,initDemoData:l}}),le={class:"data-toolbar"},ne={class:"toolbar-right"},de={class:"btn-group"},oe=C({__name:"DataToolbar",emits:["addVariable","addTable","import","export"],setup(h){return(s,t)=>(p(),b("div",le,[t[8]||(t[8]=e("div",{class:"toolbar-left"},[e("h2",null,"数据管理")],-1)),e("div",ne,[e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=l=>s.$emit("addVariable"))},t[4]||(t[4]=[e("span",{class:"icon"},"📊",-1),G(" 添加变量 ",-1)])),e("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=l=>s.$emit("addTable"))},t[5]||(t[5]=[e("span",{class:"icon"},"🗃️",-1),G(" 添加数据表 ",-1)])),e("div",de,[e("button",{class:"btn btn-secondary",onClick:t[2]||(t[2]=l=>s.$emit("import"))},t[6]||(t[6]=[e("span",{class:"icon"},"📥",-1),G(" 导入 ",-1)])),e("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=l=>s.$emit("export"))},t[7]||(t[7]=[e("span",{class:"icon"},"📤",-1),G(" 导出 ",-1)]))])])]))}}),ie=F(oe,[["__scopeId","data-v-e0d3f309"]]),re={class:"variable-list"},ue={class:"section-header"},ce={class:"count"},pe={class:"list-content"},be=["onClick"],fe={class:"variable-info"},me={class:"variable-name"},ve={class:"variable-type"},_e={class:"variable-value"},$e={class:"variable-actions"},he=["onClick"],Te=["onClick"],ye={key:0,class:"empty-state"},ge=C({__name:"VariableList",props:{variables:{}},emits:["edit","delete"],setup(h){const s=t=>t==null?"":typeof t=="string"?t.length>20?t.substring(0,20)+"...":t:typeof t=="object"?JSON.stringify(t).substring(0,20)+"...":String(t);return(t,l)=>(p(),b("div",re,[e("div",ue,[l[0]||(l[0]=e("h3",null,"运行时变量",-1)),e("span",ce,g(t.variables.length),1)]),e("div",pe,[(p(!0),b(I,null,U(t.variables,n=>(p(),b("div",{key:n.id,class:"variable-item",onClick:R=>t.$emit("edit",n.id)},[e("div",fe,[e("span",me,g(n.name),1),e("span",ve,g(n.type),1),e("span",_e,g(s(n.value)),1)]),e("div",$e,[e("button",{class:"action-btn edit",onClick:L(R=>t.$emit("edit",n.id),["stop"]),title:"编辑变量"}," ✏️ ",8,he),e("button",{class:"action-btn delete",onClick:L(R=>t.$emit("delete",n.id),["stop"]),title:"删除变量"}," ✕ ",8,Te)])],8,be))),128)),t.variables.length===0?(p(),b("div",ye,l[1]||(l[1]=[e("p",null,"暂无变量",-1),e("small",null,'点击工具栏的"添加变量"按钮创建第一个变量',-1)]))):A("",!0)])]))}}),De=F(ge,[["__scopeId","data-v-ecf538a1"]]),Re={class:"table-list"},ke={class:"section-header"},Ve={class:"count"},we={class:"list-content"},Ae=["onClick"],Ce={class:"table-info"},Fe={class:"table-name"},Ne={class:"table-meta"},Se={key:0,class:"table-description"},Ee={class:"table-actions"},Ie=["onClick"],Ue=["onClick"],Oe={key:0,class:"empty-state"},Be=C({__name:"TableList",props:{tables:{},currentTableId:{}},emits:["select-table","edit","delete"],setup(h){return(s,t)=>(p(),b("div",Re,[e("div",ke,[t[0]||(t[0]=e("h3",null,"数据表",-1)),e("span",Ve,g(s.tables.length),1)]),e("div",we,[(p(!0),b(I,null,U(s.tables,l=>(p(),b("div",{key:l.id,class:M(["table-item",{active:l.id===s.currentTableId}]),onClick:n=>s.$emit("select-table",l.id)},[e("div",Ce,[e("span",Fe,g(l.name),1),e("span",Ne,g(l.fields.length)+" 字段 · "+g(l.records.length)+" 记录 ",1),l.description?(p(),b("span",Se,g(l.description),1)):A("",!0)]),e("div",Ee,[e("button",{class:"action-btn edit",onClick:L(n=>s.$emit("edit",l.id),["stop"]),title:"编辑表信息"}," ✏️ ",8,Ie),e("button",{class:"action-btn delete",onClick:L(n=>s.$emit("delete",l.id),["stop"]),title:"删除数据表"}," ✕ ",8,Ue)])],10,Ae))),128)),s.tables.length===0?(p(),b("div",Oe,t[1]||(t[1]=[e("p",null,"暂无数据表",-1),e("small",null,'点击工具栏的"添加数据表"按钮创建第一个数据表',-1)]))):A("",!0)])]))}}),qe=F(Be,[["__scopeId","data-v-aad78b7f"]]),Le={class:"data-sidebar"},Me=C({__name:"DataSidebar",props:{variables:{},tables:{},currentTableId:{}},emits:["selectTable","editVariable","deleteVariable","editTable","deleteTable"],setup(h){return(s,t)=>(p(),b("div",Le,[N(De,{variables:s.variables,onEdit:t[0]||(t[0]=l=>s.$emit("editVariable",l)),onDelete:t[1]||(t[1]=l=>s.$emit("deleteVariable",l))},null,8,["variables"]),N(qe,{tables:s.tables,"current-table-id":s.currentTableId,onSelectTable:t[2]||(t[2]=l=>s.$emit("selectTable",l)),onEdit:t[3]||(t[3]=l=>s.$emit("editTable",l)),onDelete:t[4]||(t[4]=l=>s.$emit("deleteTable",l))},null,8,["tables","current-table-id"])]))}}),Ge=F(Me,[["__scopeId","data-v-a25b208e"]]),je={class:"schema-editor"},Je={class:"editor-layout"},Pe={class:"left-panel"},ze={class:"section"},Ke={class:"section-content"},Xe={class:"form-row"},Ye={class:"form-row"},Ze={class:"form-row"},He={class:"stats-grid"},Qe={class:"stat-item"},We={class:"stat-value"},xe={class:"stat-item"},et={class:"stat-value"},tt={class:"stat-item"},st={class:"stat-value"},at={class:"stat-item"},lt={class:"stat-value"},nt={class:"right-panel"},dt={class:"section"},ot={class:"section-header"},it={class:"section-content"},rt={key:0,class:"empty-state"},ut={key:1,class:"fields-list"},ct={class:"field-header"},pt={class:"field-name"},bt={class:"field-actions"},ft=["onClick"],mt=["onClick"],vt={class:"field-meta"},_t={class:"field-type"},$t={key:0,class:"field-required"},ht={key:0,class:"field-description"},Tt={key:1,class:"field-default"},yt={class:"default-value"},gt={class:"dialog-content"},Dt={class:"form-row"},Rt={class:"form-row"},kt={class:"form-row"},Vt={class:"form-row"},wt={class:"form-row"},At={class:"form-checkbox"},Ct=C({__name:"SchemaEditor",props:{table:{}},emits:["updateTable","addField","updateField","deleteField"],setup(h,{emit:s}){const t=h,l=s,n=P({name:t.table.name,description:t.table.description||""}),R=q(!1),i=P({name:"",type:$.STRING,description:"",defaultValue:"",required:!1}),_=()=>{l("updateTable",{name:n.name,description:n.description})},f=()=>{i.name.trim()&&(l("addField",{name:i.name.trim(),type:i.type}),V())},D=v=>{console.log("编辑字段:",v)},S=v=>{confirm("确定要删除这个字段吗？")&&l("deleteField",v)},V=()=>{R.value=!1,Object.assign(i,{name:"",type:$.STRING,description:"",defaultValue:"",required:!1})},E=v=>({[$.STRING]:"文本",[$.NUMBER]:"数字",[$.BOOLEAN]:"布尔值",[$.DATE]:"日期",[$.JSON]:"JSON"})[v]||"未知",m=v=>new Date(v).toLocaleDateString("zh-CN");return(v,a)=>{var k;return p(),b("div",je,[e("div",Je,[e("div",Pe,[e("div",ze,[a[16]||(a[16]=e("div",{class:"section-header"},[e("h3",{class:"section-title"},"基本信息")],-1)),e("div",Ke,[e("div",Xe,[a[9]||(a[9]=e("label",{class:"form-label"},"表名称",-1)),w(e("input",{"onUpdate:modelValue":a[0]||(a[0]=u=>n.name=u),class:"form-input",placeholder:"请输入数据表名称",onBlur:_},null,544),[[O,n.name]])]),e("div",Ye,[a[10]||(a[10]=e("label",{class:"form-label"},"描述",-1)),w(e("textarea",{"onUpdate:modelValue":a[1]||(a[1]=u=>n.description=u),class:"form-textarea",placeholder:"请输入数据表描述（可选）",rows:"4",onBlur:_},null,544),[[O,n.description]])]),e("div",Ze,[a[15]||(a[15]=e("label",{class:"form-label"},"统计信息",-1)),e("div",He,[e("div",Qe,[a[11]||(a[11]=e("span",{class:"stat-label"},"字段数量",-1)),e("span",We,g(v.table.fields.length),1)]),e("div",xe,[a[12]||(a[12]=e("span",{class:"stat-label"},"记录数量",-1)),e("span",et,g(((k=v.table.records)==null?void 0:k.length)||0),1)]),e("div",tt,[a[13]||(a[13]=e("span",{class:"stat-label"},"创建时间",-1)),e("span",st,g(m(v.table.createdAt)),1)]),e("div",at,[a[14]||(a[14]=e("span",{class:"stat-label"},"更新时间",-1)),e("span",lt,g(m(v.table.updatedAt)),1)])])])])])]),e("div",nt,[e("div",dt,[e("div",ot,[a[18]||(a[18]=e("h3",{class:"section-title"},"字段定义",-1)),e("button",{class:"btn btn-primary",onClick:a[2]||(a[2]=u=>R.value=!0)},a[17]||(a[17]=[e("span",{class:"btn-icon"},"+",-1),e("span",{class:"btn-text"},"添加字段",-1)]))]),e("div",it,[v.table.fields.length===0?(p(),b("div",rt,a[19]||(a[19]=[e("div",{class:"empty-icon"},"📝",-1),e("p",{class:"empty-text"},"暂无字段，点击上方按钮添加第一个字段",-1)]))):(p(),b("div",ut,[(p(!0),b(I,null,U(v.table.fields,u=>(p(),b("div",{key:u.id,class:"field-card"},[e("div",ct,[e("div",pt,g(u.name),1),e("div",bt,[e("button",{class:"action-btn edit",onClick:d=>D(u),title:"编辑字段"}," ✏️ ",8,ft),e("button",{class:"action-btn delete",onClick:d=>S(u.id),title:"删除字段"}," 🗑️ ",8,mt)])]),e("div",vt,[e("span",_t,g(E(u.type)),1),u.required?(p(),b("span",$t,"必填")):A("",!0)]),u.description?(p(),b("div",ht,g(u.description),1)):A("",!0),u.defaultValue?(p(),b("div",Tt,[a[20]||(a[20]=e("span",{class:"default-label"},"默认值:",-1)),e("span",yt,g(u.defaultValue),1)])):A("",!0)]))),128))]))])])])]),R.value?(p(),b("div",{key:0,class:"dialog-overlay",onClick:V},[e("div",{class:"dialog",onClick:a[8]||(a[8]=L(()=>{},["stop"]))},[e("div",{class:"dialog-header"},[a[21]||(a[21]=e("h3",null,"添加字段",-1)),e("button",{class:"dialog-close",onClick:V},"×")]),e("div",gt,[e("div",Dt,[a[22]||(a[22]=e("label",{class:"form-label"},"字段名称",-1)),w(e("input",{"onUpdate:modelValue":a[3]||(a[3]=u=>i.name=u),class:"form-input",placeholder:"请输入字段名称"},null,512),[[O,i.name]])]),e("div",Rt,[a[24]||(a[24]=e("label",{class:"form-label"},"字段类型",-1)),w(e("select",{"onUpdate:modelValue":a[4]||(a[4]=u=>i.type=u),class:"form-select"},a[23]||(a[23]=[Y('<option value="string" data-v-9d7eab4f>文本</option><option value="number" data-v-9d7eab4f>数字</option><option value="boolean" data-v-9d7eab4f>布尔值</option><option value="date" data-v-9d7eab4f>日期</option><option value="json" data-v-9d7eab4f>JSON</option>',5)]),512),[[Z,i.type]])]),e("div",kt,[a[25]||(a[25]=e("label",{class:"form-label"},"描述",-1)),w(e("input",{"onUpdate:modelValue":a[5]||(a[5]=u=>i.description=u),class:"form-input",placeholder:"请输入字段描述（可选）"},null,512),[[O,i.description]])]),e("div",Vt,[a[26]||(a[26]=e("label",{class:"form-label"},"默认值",-1)),w(e("input",{"onUpdate:modelValue":a[6]||(a[6]=u=>i.defaultValue=u),class:"form-input",placeholder:"请输入默认值（可选）"},null,512),[[O,i.defaultValue]])]),e("div",wt,[e("label",At,[w(e("input",{"onUpdate:modelValue":a[7]||(a[7]=u=>i.required=u),type:"checkbox"},null,512),[[H,i.required]]),a[27]||(a[27]=e("span",{class:"checkbox-text"},"必填字段",-1))])])]),e("div",{class:"dialog-footer"},[e("button",{class:"btn btn-secondary",onClick:V},"取消"),e("button",{class:"btn btn-primary",onClick:f},"确定")])])])):A("",!0)])}}}),Ft=F(Ct,[["__scopeId","data-v-9d7eab4f"]]),Nt={class:"data-records"},St={class:"records-header"},Et={class:"header-info"},It={class:"records-count"},Ut={class:"records-content"},Ot={key:0,class:"empty-state"},Bt={key:1,class:"empty-state"},qt={key:2,class:"table-container"},Lt={class:"records-table"},Mt={class:"header-content"},Gt={class:"field-name"},jt={key:0,class:"required-mark"},Jt={class:"field-type"},Pt={class:"row-number"},zt={class:"actions-cell"},Kt={class:"action-buttons"},Xt=["onClick"],Yt=["onClick"],Zt=C({__name:"DataRecords",props:{fields:{},records:{}},emits:["addRecord","updateRecord","deleteRecord"],setup(h,{emit:s}){const t=s,l=()=>{t("addRecord",{})},n=(m,v)=>{t("updateRecord",{index:m,updates:v})},R=m=>{},i=m=>{confirm("确定要删除这条记录吗？")&&t("deleteRecord",m)},_=m=>({"field-required":m.required,[`field-${m.type}`]:!0}),f=m=>({[$.STRING]:"文本",[$.NUMBER]:"数字",[$.BOOLEAN]:"布尔值",[$.DATE]:"日期",[$.JSON]:"JSON"})[m]||"未知",D=m=>{switch(m){case $.BOOLEAN:return"input";case $.DATE:return"input";default:return"input"}},S=m=>{switch(m){case $.NUMBER:return"number";case $.DATE:return"date";case $.BOOLEAN:return"checkbox";default:return"text"}},V=m=>({"form-input":!0,required:m.required,[`input-${m.type}`]:!0}),E=m=>m.description||`请输入${m.name}`;return(m,v)=>(p(),b("div",Nt,[e("div",St,[e("div",Et,[v[0]||(v[0]=e("h3",{class:"records-title"},"数据记录",-1)),e("span",It,g(m.records.length)+" 条记录",1)]),e("button",{class:"btn btn-primary",onClick:l},v[1]||(v[1]=[e("span",{class:"btn-icon"},"+",-1),e("span",{class:"btn-text"},"添加记录",-1)]))]),e("div",Ut,[m.fields.length===0?(p(),b("div",Ot,v[2]||(v[2]=[e("div",{class:"empty-icon"},"📝",-1),e("p",{class:"empty-text"},"请先在字段设计页面添加字段",-1)]))):m.records.length===0?(p(),b("div",Bt,v[3]||(v[3]=[e("div",{class:"empty-icon"},"📊",-1),e("p",{class:"empty-text"},"暂无数据记录，点击上方按钮添加第一条记录",-1)]))):(p(),b("div",qt,[e("table",Lt,[e("thead",null,[e("tr",null,[v[4]||(v[4]=e("th",{class:"row-number"},"#",-1)),(p(!0),b(I,null,U(m.fields,a=>(p(),b("th",{key:a.id,class:M(_(a))},[e("div",Mt,[e("span",Gt,g(a.name),1),a.required?(p(),b("span",jt,"*")):A("",!0)]),e("div",Jt,g(f(a.type)),1)],2))),128)),v[5]||(v[5]=e("th",{class:"actions-header"},"操作",-1))])]),e("tbody",null,[(p(!0),b(I,null,U(m.records,(a,k)=>(p(),b("tr",{key:k,class:"record-row"},[e("td",Pt,g(k+1),1),(p(!0),b(I,null,U(m.fields,u=>(p(),b("td",{key:u.id,class:"record-cell"},[(p(),Q(W(D(u.type)),{modelValue:a[u.name],"onUpdate:modelValue":d=>a[u.name]=d,type:S(u.type),class:M(V(u)),placeholder:E(u),onBlur:d=>n(k,a),onChange:d=>n(k,a)},null,40,["modelValue","onUpdate:modelValue","type","class","placeholder","onBlur","onChange"]))]))),128)),e("td",zt,[e("div",Kt,[e("button",{class:"action-btn duplicate",onClick:u=>R(),title:"复制记录"}," 📋 ",8,Xt),e("button",{class:"action-btn delete",onClick:u=>i(k),title:"删除记录"}," 🗑️ ",8,Yt)])])]))),128))])])]))])]))}}),Ht=F(Zt,[["__scopeId","data-v-5cd036e5"]]),Qt={class:"data-editor"},Wt={class:"tab-nav"},xt={class:"tab-badge"},es={class:"tab-content"},ts={class:"tab-panel"},ss={class:"tab-panel"},as=C({__name:"DataEditor",props:{table:{},fields:{},records:{}},emits:["updateTable","addField","updateField","deleteField","addRecord","updateRecord","deleteRecord"],setup(h,{emit:s}){const t=s,l=q("schema");function n(_){t("addField",_)}function R(_){t("updateField",_)}function i(_){t("updateRecord",_)}return(_,f)=>(p(),b("div",Qt,[e("div",Wt,[e("button",{class:M(["tab-btn",{active:l.value==="schema"}]),onClick:f[0]||(f[0]=D=>l.value="schema")},f[6]||(f[6]=[e("span",{class:"tab-icon"},"🏗️",-1),e("span",{class:"tab-text"},"字段设计",-1)]),2),e("button",{class:M(["tab-btn",{active:l.value==="data"}]),onClick:f[1]||(f[1]=D=>l.value="data")},[f[7]||(f[7]=e("span",{class:"tab-icon"},"📊",-1)),f[8]||(f[8]=e("span",{class:"tab-text"},"数据记录",-1)),e("span",xt,g(_.records.length),1)],2)]),e("div",es,[w(e("div",ts,[N(Ft,{table:_.table,onUpdateTable:f[2]||(f[2]=D=>_.$emit("updateTable",D)),onAddField:n,onUpdateField:R,onDeleteField:f[3]||(f[3]=D=>_.$emit("deleteField",D))},null,8,["table"])],512),[[z,l.value==="schema"]]),w(e("div",ss,[N(Ht,{fields:_.fields,records:_.records,onAddRecord:f[4]||(f[4]=D=>_.$emit("addRecord",D)),onUpdateRecord:i,onDeleteRecord:f[5]||(f[5]=D=>_.$emit("deleteRecord",D))},null,8,["fields","records"])],512),[[z,l.value==="data"]])])]))}}),ls=F(as,[["__scopeId","data-v-19d7eb87"]]),ns={class:"data-content"},ds={key:0,class:"table-container"},os=C({__name:"DataContent",props:{currentTable:{}},emits:["updateTable","addField","updateField","deleteField","addRecord","updateRecord","deleteRecord"],setup(h,{emit:s}){const t=s,l=i=>{t("addField",i.name,i.type)};function n(i){t("updateField",i.fieldId,i.updates)}function R(i){t("updateRecord",i.index,i.updates)}return(i,_)=>(p(),b("div",ns,[i.currentTable?(p(),b("div",ds,[N(ls,{table:i.currentTable,fields:i.currentTable.fields,records:i.currentTable.records,onUpdateTable:_[0]||(_[0]=f=>i.$emit("updateTable",f)),onAddField:l,onUpdateField:n,onDeleteField:_[1]||(_[1]=f=>i.$emit("deleteField",f)),onAddRecord:_[2]||(_[2]=f=>i.$emit("addRecord",f)),onUpdateRecord:R,onDeleteRecord:_[3]||(_[3]=f=>i.$emit("deleteRecord",f))},null,8,["table","fields","records"])])):A("",!0)]))}}),is=F(os,[["__scopeId","data-v-7495ea24"]]),rs={class:"data-view"},us={class:"data-main"},cs=C({__name:"DataView",setup(h){const s=ae(),{variables:t,tables:l,currentTableId:n,currentTable:R}=x(s);ee(()=>{s.initDemoData()});const i=()=>{const o=prompt("请输入变量名称:");if(o&&o.trim())try{s.addVariable(o.trim(),$.STRING,"")}catch(y){console.error("添加变量失败:",y),alert("添加变量失败，请重试")}},_=()=>{const o=prompt("请输入数据表名称:");if(o){const y=s.addTable(o);s.selectTable(y.id)}},f=()=>{console.log("导入数据")},D=()=>{console.log("导出数据")},S=o=>{console.log("编辑变量:",o)},V=o=>{console.log("编辑表:",o)},E=o=>{n.value&&s.updateTable(n.value,o)},m=(o,y)=>{n.value&&s.updateField(n.value,o,y)},v=(o,y)=>{n.value&&s.addField(n.value,o,y)},a=o=>{n.value&&s.deleteField(n.value,o)},k=o=>{n.value&&s.addRecord(n.value,o)},u=(o,y)=>{n.value&&s.updateRecord(n.value,o,y)},d=o=>{n.value&&s.deleteRecord(n.value,o)},c=o=>{s.selectTable(o)},r=o=>{s.deleteVariable(o)},T=o=>{s.deleteTable(o)};return(o,y)=>(p(),b("div",rs,[N(ie,{onAddVariable:i,onAddTable:_,onImport:f,onExport:D}),e("div",us,[N(Ge,{variables:j(t),tables:j(l),"current-table-id":j(n),onSelectTable:c,onEditVariable:S,onDeleteVariable:r,onEditTable:V,onDeleteTable:T},null,8,["variables","tables","current-table-id"]),N(is,{"current-table":j(R),onUpdateTable:E,onAddField:v,onUpdateField:m,onDeleteField:a,onAddRecord:k,onUpdateRecord:u,onDeleteRecord:d},null,8,["current-table"])])]))}}),bs=F(cs,[["__scopeId","data-v-6684b2df"]]);export{bs as default};
